% ===============================================================================
% CV_STYLE.TEX - Sistema di stili completamente ottimizzato per CV LaTeX
% ===============================================================================
% Versione: 3.0 - Riscrittura completa per controllo precisione spacing
% Descrizione: Framework LaTeX ottimizzato per CV a singola pagina con controllo millimetrico
% ===============================================================================

% ----- GESTIONE PACCHETTI E DIPENDENZE -----
\RequirePackage[a4paper, margin=0.8cm, top=0.7cm, bottom=0.7cm, hmarginratio=1:1]{geometry}
\RequirePackage{fontspec}
\RequirePackage{xcolor}
\RequirePackage{fontawesome5}
\RequirePackage{simpleicons}
\RequirePackage{hyperref}
\RequirePackage{tabularx}
\RequirePackage{enumitem}
\RequirePackage{graphicx}
\RequirePackage{adjustbox}
\RequirePackage{ragged2e}
\RequirePackage{titlesec}
\RequirePackage{multicol}
\RequirePackage{calc}
\RequirePackage{array}

% ----- CONFIGURAZIONI GLOBALI OTTIMIZZATE -----
% Font principale
\setmainfont{Lato}

% Importazione palette colori (preserviamo i file esistenti)
\input{cv_colors.tex}
\input{tech_brand_colors.tex}

% Configurazioni hyperref
\hypersetup{
    colorlinks=true,
    urlcolor=accentColor,
    linkcolor=accentColor,
    pdfborder={0 0 0},
    pdftitle={CV - Filippo Falcone},
    pdfauthor={Filippo Falcone},
    hidelinks
}

% Configurazioni globali per performance e compattezza
\pagestyle{empty}
\setlist{leftmargin=*, label=, noitemsep, parsep=0pt}
\setlength{\parindent}{0pt}
\setlength{\parskip}{0pt}

% ----- SISTEMA DI SPACING OTTIMIZZATO -----
% Unità base ultra-compatta per massima precisione
\newlength{\tinyspace}
\newlength{\microspace}
\newlength{\minispacing}
\newlength{\compactspace}
\newlength{\normalspace}
\newlength{\mediumspace}

\setlength{\tinyspace}{1pt}
\setlength{\microspace}{2pt}
\setlength{\minispacing}{3pt}
\setlength{\compactspace}{4pt}
\setlength{\normalspace}{6pt}
\setlength{\mediumspace}{8pt}

% Comando spacing personalizzato con controllo preciso
\newcommand{\cvspace}[1]{\vspace{#1}}

% ----- CONFIGURAZIONI FONT OTTIMIZZATE -----
\newcommand{\cvMainFontSize}{11pt}
\newcommand{\cvHeaderNameSize}{20pt}         % Nome più grande
\newcommand{\cvHeaderTitleSize}{14pt}        % Professione più grande
\newcommand{\cvSectionFontSize}{13pt}
\newcommand{\cvEntryFontSize}{11pt}
\newcommand{\cvSmallFontSize}{9pt}
\newcommand{\cvTinyFontSize}{8pt}

% Line heights compatti
\newcommand{\cvMainLineHeight}{12pt}
\newcommand{\cvCompactLineHeight}{11pt}
\newcommand{\cvTightLineHeight}{10pt}

% Font setup globale compatto
\AtBeginDocument{
    \fontsize{\cvMainFontSize}{\cvMainLineHeight}\selectfont
    \justify
    \setlength{\spaceskip}{0.33em plus 0.2em minus 0.1em}
}

% ----- LAYOUT A DUE COLONNE OTTIMIZZATO -----
\newlength{\leftcolumnwidth}
\newlength{\rightcolumnwidth}
\newlength{\columnseparation}

\setlength{\leftcolumnwidth}{0.60\textwidth}
\setlength{\rightcolumnwidth}{0.32\textwidth}
\setlength{\columnseparation}{0.08\textwidth}

% Variabili per gestione colonne
\newif\ifinleftcolumn
\inleftcolumnfalse

% ----- HEADER OTTIMIZZATO -----
\newcommand{\leftheader}[2]{%
    \vspace{15cm}% Spostiamo il titolo molto più in basso, circa a metà pagina
    \begin{minipage}{\textwidth}
        \fontsize{\cvHeaderNameSize}{22pt}\selectfont
        \textbf{\color{primaryColor}#1} \\[3pt]
        \fontsize{\cvHeaderTitleSize}{16pt}\selectfont
        \color{secondaryColor}#2
    \end{minipage}
    \vspace{20pt}% Spazio aggiuntivo tra titolo e contenuto
}

% ----- SEZIONI OTTIMIZZATE -----
\titleformat{\section}
    {\fontsize{\cvSectionFontSize}{\cvCompactLineHeight}\selectfont\bfseries\color{primaryColor}}
    {}{0pt}{}
    [\vspace{1pt}\color{accentColor}\hrule height 1pt\vspace{\minispacing}]

% ----- GESTIONE COLONNE OTTIMIZZATA -----
\newcommand{\cvstartleftcolumn}{%
    \inleftcolumntrue
    \begin{minipage}{\leftcolumnwidth}
    \justify
    \setlength{\parindent}{0pt}
}

\newcommand{\cvrightcolumn}{%
    \end{minipage}%
    \hfill
    \begin{minipage}{\rightcolumnwidth}
    \vspace{-40pt}% Spostiamo la colonna destra verso l'alto
    \raggedright
    \inleftcolumnfalse
}

\newcommand{\cvendcolumns}{%
    \end{minipage}
}

% ----- ENTRY PROGETTI OTTIMIZZATO -----
\newcommand{\cvproject}[3]{%
    \noindent\textbf{\fontsize{\cvEntryFontSize}{\cvCompactLineHeight}\selectfont\color{secondaryColor}#1}%
    \\[1pt]%
    \noindent\textit{\fontsize{\cvSmallFontSize}{\cvTightLineHeight}\selectfont\color{darkGray}#2}%
    \\[\microspace]%
    \begin{itemize}[leftmargin=12pt, itemsep=-2pt, parsep=0pt, topsep=0pt, partopsep=0pt]%
        \fontsize{\cvSmallFontSize}{\cvTightLineHeight}\selectfont%
        #3%
    \end{itemize}%
}

% ----- SIDEBAR OTTIMIZZATA -----
\newcommand{\sidebarsection}[1]{%
    \cvspace{\minispacing}%
    \textbf{\fontsize{\cvSectionFontSize}{\cvCompactLineHeight}\selectfont\color{primaryColor}#1}%
    \\[2pt]%
    \color{accentColor}\hrule height 1pt%
    \cvspace{\microspace}%
}

% ----- FOTO PROFILO OTTIMIZZATA -----
\newcommand{\profilephoto}[1]{%
    \begin{center}
        \includegraphics[width=0.85\textwidth]{#1}
    \end{center}
    \cvspace{\microspace}
}

% ----- CONTATTI OTTIMIZZATI -----
\newcommand{\contactitemtext}[2]{%
    \textcolor{accentColor}{\faIcon{#1}} \hspace{2pt}%
    \fontsize{\cvTinyFontSize}{\cvTightLineHeight}\selectfont\color{darkGray}#2%
}

\newcommand{\contactitemlabel}[3]{%
    \textcolor{accentColor}{\faIcon{#1}} \hspace{2pt}%
    \href{#2}{\fontsize{\cvTinyFontSize}{\cvTightLineHeight}\selectfont\color{darkGray}#3}%
}

% ----- COMPETENZE TECNICHE OTTIMIZZATE -----
\newcommand{\techskill}[3]{%
    \textcolor{#2}{\simpleicon{#1}} \hspace{2pt}%
    \fontsize{\cvTinyFontSize}{\cvTightLineHeight}\selectfont\color{darkGray}#3%
}

\newcommand{\techskillfa}[3]{%
    \textcolor{#2}{\faIcon{#1}} \hspace{2pt}%
    \fontsize{\cvTinyFontSize}{\cvTightLineHeight}\selectfont\color{darkGray}#3%
}

% ----- FORMAZIONE OTTIMIZZATA -----
\newcommand{\educationentry}[3]{%
    \cvspace{\minispacing}%
    \textbf{\fontsize{\cvSmallFontSize}{\cvTightLineHeight}\selectfont\color{secondaryColor}#1}%
    \\[1pt]%
    \textit{\fontsize{\cvTinyFontSize}{\cvTightLineHeight}\selectfont\color{darkGray}#2}%
    \\[\tinyspace]%
    \fontsize{\cvTinyFontSize}{\cvTightLineHeight}\selectfont\color{darkGray}#3%
    \cvspace{\microspace}%
}

% ----- SISTEMA DI COLORI AGGIUNTIVI -----
% Definizione di colori aggiuntivi per Node.js che mancava
\definecolor{NodeJSColor}{HTML}{8CC84B}

% ===============================================================================
% FINE CV_STYLE.TEX - Sistema Ottimizzato v3.0
% ===============================================================================