% ===============================================================================
% CV_STYLE.TEX - Sistema di stili modulare e scalabile per CV LaTeX
% ===============================================================================
% Versione: 2.0
% Autore: CV Template System
% Descrizione: Framework LaTeX ottimizzato per CV professionali con architettura modulare
% ===============================================================================

% ----- GESTIONE PACCHETTI E DIPENDENZE -----
\RequirePackage[a4paper, margin=1cm, top=0.8cm, bottom=0.8cm, hmarginratio=1:1]{geometry}
\RequirePackage{fontspec}
\RequirePackage{xcolor}
\RequirePackage{fontawesome5}
\RequirePackage{simpleicons}
\RequirePackage{hyperref}
\RequirePackage{tabularx}
\RequirePackage{enumitem}
\RequirePackage{graphicx}
\RequirePackage{titlesec}
\RequirePackage{multicol}
\RequirePackage{calc} % Per calcoli matematici avanzati

% ----- CONFIGURAZIONI GLOBALI SCALABILI -----
% Font principale configurabile
\providecommand{\cvMainFont}{Lato}
\setmainfont{\cvMainFont}

% Importazione palette colori modulare
\input{cv_colors.tex}
\input{tech_brand_colors.tex}

% Configurazioni hyperref ottimizzate
\hypersetup{
    colorlinks=true,
    urlcolor=accentColor,
    linkcolor=accentColor,
    pdfborder={0 0 0},
    pdftitle={CV - Curriculum Vitae},
    pdfauthor={CV Template System},
    pdfsubject={Professional CV Template},
    hidelinks
}

% Configurazioni globali per performance
\pagestyle{empty}
\setlist{leftmargin=*, label=, noitemsep, parsep=0pt}

% Font size di base configurabile
\AtBeginDocument{
    \fontsize{11pt}{13.2pt}\selectfont
}

% ----- SISTEMA DI DIMENSIONI MODULARI -----
% Unità base scalabile per tutto il layout
\newlength{\baseunit}
\setlength{\baseunit}{4pt}

% Dimensioni derivate per scalabilità
\newlength{\smallspace}
\newlength{\mediumspace}
\newlength{\largespace}
\newlength{\hugespace}

\setlength{\smallspace}{\baseunit}
\setlength{\mediumspace}{2\baseunit}
\setlength{\largespace}{3\baseunit}
\setlength{\hugespace}{6\baseunit}

% ----- CONFIGURAZIONI LAYOUT RESPONSIVE -----
% Proporzioni layout configurabili e bilanciate
\newcommand{\cvLeftColumnWidth}{0.52}
\newcommand{\cvRightColumnWidth}{0.365}
\newcommand{\cvColumnSeparation}{0.075}
\newcommand{\cvMarginLeft}{0.02}
\newcommand{\cvMarginRight}{0.02}

% ----- SISTEMA DI TIPOGRAFIA SCALABILE -----
% Dimensioni font configurabili con rapporti matematici
\newcommand{\cvFontSizeHuge}{20pt}
\newcommand{\cvLineHeightHuge}{24pt}
\newcommand{\cvFontSizeLarge}{16pt}
\newcommand{\cvLineHeightLarge}{19.2pt}
\newcommand{\cvFontSizeSection}{14pt}
\newcommand{\cvLineHeightSection}{16.8pt}
\newcommand{\cvFontSizeSubsection}{13.5pt}
\newcommand{\cvLineHeightSubsection}{16.2pt}
\newcommand{\cvFontSizeEntry}{13pt}
\newcommand{\cvLineHeightEntry}{15.6pt}
\newcommand{\cvFontSizeNormal}{11pt}
\newcommand{\cvLineHeightNormal}{13.2pt}
\newcommand{\cvFontSizeSmall}{10pt}
\newcommand{\cvLineHeightSmall}{12pt}

% ----- COMANDI STRUTTURALI OTTIMIZZATI -----

% Titolo di sezione con parametri scalabili
\titleformat{\section}
  {\fontsize{\cvFontSizeSection}{\cvLineHeightSection}\selectfont\bfseries\color{primaryColor}}
  {}
  {0em}
  {}[\titlerule]
\titlespacing*{\section}{0pt}{\hugespace}{\largespace}

% Header centrato modulare
\newcommand{\cvheader}[2]{
    \begin{center}
        {\fontsize{\cvFontSizeHuge}{\cvLineHeightHuge}\selectfont\bfseries\color{primaryColor} #1}\\[\mediumspace]
        {\fontsize{\cvFontSizeLarge}{\cvLineHeightLarge}\selectfont\color{secondaryColor} #2}
    \end{center}
    \vspace{\hugespace}
}

% Header allineato a sinistra con offset configurabile
\newcommand{\leftheader}[2]{
    \noindent\hspace{2.5cm}
    {\fontsize{\cvFontSizeHuge}{\cvLineHeightHuge}\selectfont\bfseries\color{primaryColor} #1}
    
    \noindent\hspace{2.5cm}
    {\fontsize{\cvFontSizeLarge}{\cvLineHeightLarge}\selectfont\color{secondaryColor} #2}
    
    \vspace{\hugespace}
}

% ----- SISTEMA LAYOUT MODULARE -----
% Layout a due colonne con proporzioni configurabili
\def\cvstartleftcolumn{%
    \hspace*{\cvMarginLeft\textwidth}%
    \begin{minipage}[t]{\cvLeftColumnWidth\textwidth}%
    \raggedright%
    \vspace{0pt}%
}

\def\cvrightcolumn{%
    \end{minipage}%
    \hspace{\cvColumnSeparation\textwidth}%
    \begin{minipage}[t]{\cvRightColumnWidth\textwidth}%
    \raggedright%
}

\def\cvendcolumns{%
    \end{minipage}%
    \hspace*{\cvMarginRight\textwidth}%
}

% ----- COMPONENTI MEDIA OTTIMIZZATI -----
% Foto profilo con parametri configurabili
\newcommand{\profilephoto}[2][width=\textwidth, clip, trim=0 130 0 130]{
    \vspace{-\hugespace}%
    \includegraphics[#1]{#2}%
    \vspace{\mediumspace}%
}

% ----- SISTEMA CONTATTI MODULARE -----
% Comando base per contatti con icona
\newcommand{\cvcontactbase}[3]{%
    \textcolor{primaryColor}{\faIcon{#1}}\hspace{3pt}%
    \textcolor{secondaryColor}{#3}%
}

% Contatto con link clickable
\newcommand{\contactitem}[2]{%
    \cvcontactbase{#1}{\href{#2}{#2}}{%
        \href{#2}{\mbox{\hyphenchar\font=\defaulthyphenchar#2}}%
    }%
}

% Contatto solo testo
\newcommand{\contactitemtext}[2]{%
    \cvcontactbase{#1}{}{#2}%
}

% Contatto con label personalizzata
\newcommand{\contactitemlabel}[3]{%
    \cvcontactbase{#1}{\href{#2}{#3}}{%
        \href{#2}{\mbox{#3}}%
    }%
}

% ----- SISTEMA SEZIONI SIDEBAR -----
% Sezione sidebar ottimizzata
\newcommand{\sidebarsection}[1]{
    \vspace{\hugespace}%
    {\fontsize{\cvFontSizeSubsection}{\cvLineHeightSubsection}\selectfont\bfseries\color{primaryColor} #1}%
    \rule[0.5ex]{\linewidth}{0.5pt}%
    \vspace{\largespace}%
}

% ----- SISTEMA SKILLS SCALABILE -----
% Categoria di competenze
\newcommand{\skillcategory}[1]{
    \vspace{\mediumspace}%
    {\bfseries\color{secondaryColor} #1}%
}

% Skill tecniche con icona e colore personalizzabile
\newcommand{\techskill}[3]{
    \textcolor{#2}{\simpleicon{#1}}\hspace{3pt}#3%
}

% Skill senza icona (fallback)
\newcommand{\skill}[1]{
    \textcolor{secondaryColor}{#1}%
}

% ----- SISTEMA ENTRY CV MODULARE -----
% Comando base per entry con struttura comune
\newcommand{\cvbaseentry}[4]{
    \vspace{\largespace}%
    \textbf{\fontsize{\cvFontSizeEntry}{\cvLineHeightEntry}\selectfont\color{secondaryColor} #1} \hfill \textit{\color{darkGray} #2} \\%
    \textbf{\color{accentColor} #3} \\[\smallspace]%
    \begin{itemize}%
        \setlength{\itemsep}{\mediumspace}%
        #4%
    \end{itemize}%
    \vspace{\mediumspace}%
}

% Entry esperienza lavorativa
\newcommand{\cventry}[4]{
    \cvbaseentry{#1}{#2}{#3}{#4}%
}

% Entry progetto con struttura leggermente diversa
\newcommand{\cvproject}[3]{
    \vspace{\largespace}%
    \textbf{\fontsize{\cvFontSizeEntry}{\cvLineHeightEntry}\selectfont\color{secondaryColor} #1} \\%
    \textit{\small\color{darkGray} #2} \\[\smallspace]%
    \begin{itemize}%
        \setlength{\itemsep}{\mediumspace}%
        #3%
    \end{itemize}%
    \vspace{\mediumspace}%
}

% Entry formazione ottimizzata
\newcommand{\educationentry}[3]{
    \vspace{\largespace}%
    \textbf{\fontsize{\cvFontSizeEntry}{\cvLineHeightEntry}\selectfont\color{secondaryColor} #1} \\%
    \textit{\color{darkGray} #2} \\[\smallspace]%
    \textit{\fontsize{\cvFontSizeSmall}{\cvLineHeightSmall}\selectfont #3}%
    \vspace{\mediumspace}%
}

% ----- UTILITÀ E HELPER -----
% Spaziatura personalizzabile per debug e tuning
\newcommand{\cvspace}[1]{\vspace{#1\baseunit}}

% Separatore visivo
\newcommand{\cvseparator}{\rule{\linewidth}{0.5pt}}

% ----- FINE CV_STYLE.TEX -----
